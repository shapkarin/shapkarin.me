<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><link href="/favicon/favicon-96x96.png" rel="icon" sizes="96x96" type="image/png"><link href="/favicon/favicon.svg" rel="icon" type="image/svg+xml"><link href="/favicon/favicon.ico" rel="shortcut icon"><link href="/favicon/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180"><meta content="shapkarin.me" name="apple-mobile-web-app-title"><link href="/favicon/site.webmanifest" rel="manifest"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="#000000" name="theme-color"><title>Deep Cloning in JavaScript: Mastering `structuredClone()` | Iurii Shapkarin</title><meta content="Iurii Shapkarin's personal website" name="description"><meta content="website" property="og:type"><meta content="Iurii Shapkarin | Software Developer" property="og:title"><meta content="Iurii Shapkarin's personal website" property="og:description"><meta content="https://shapkarin.me" property="og:url"><meta content="Iurii Shapkarin" name="twitter:creator"><meta content="website" name="twitter:card"><meta content="Iurii Shapkarin | Software Developer" name="twitter:title"><meta content="Iurii Shapkarin's personal website" name="twitter:description"><link href="https://fonts.googleapis.com/css?family=Lato:300" rel="stylesheet"><script type="text/javascript">!function(n){if("/"===n.search[1]){var a=n.search.slice(1).split("&").map(function(n){return n.replace(/~and~/g,"&")}).join("?");window.history.replaceState(null,null,n.pathname.slice(0,-1)+a+n.hash)}}(window.location)</script><title>Iurii Shapkarin</title><link href="https://fonts.googleapis.com" rel="preconnect"><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin=""><link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet"><script defer src="/static/js/main.b537a0ef.js"></script><link href="/static/css/main.ef0e8649.css" rel="stylesheet"><link href="https://fonts.googleapis.com" rel="preconnect"><link href="https://raw.githubusercontent.com" rel="preconnect"><link href="https://fonts.gstatic.com" rel="preconnect"><link href="https://shapkarin.me/articles/structuredClone//" rel="canonical" data-react-helmet="true"><meta content="Learn how to properly create deep copies of complex objects in JavaScript using the modern structuredClone() method, understand its advantages over traditional techniques, and discover when and how to use it effectively." name="description" data-react-helmet="true"><meta content="" name="keywords" data-react-helmet="true"><meta content="article" data-react-helmet="true" property="og:type"><meta content="Deep Cloning in JavaScript: Mastering `structuredClone()` | Iurii Shapkarin" data-react-helmet="true" property="og:title"><meta content="Learn how to properly create deep copies of complex objects in JavaScript using the modern structuredClone() method, understand its advantages over traditional techniques, and discover when and how to use it effectively." data-react-helmet="true" property="og:description"><meta content="https://shapkarin.me/articles/structuredClone//" data-react-helmet="true" property="og:url"><meta content="Iurii Shapkarin" name="twitter:creator" data-react-helmet="true"><meta content="article" name="twitter:card" data-react-helmet="true"><meta content="Deep Cloning in JavaScript: Mastering `structuredClone()` | Iurii Shapkarin" name="twitter:title" data-react-helmet="true"><meta content="Learn how to properly create deep copies of complex objects in JavaScript using the modern structuredClone() method, understand its advantages over traditional techniques, and discover when and how to use it effectively." name="twitter:description" data-react-helmet="true"><script type="application/ld+json" data-react-helmet="true">[{"@context":"https://schema.org","@type":"Article","learningResourceType":["tutorial","reading"],"educationalUse":["learning","teaching","presentation"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://shapkarin.me/articles/structuredClone/"},"url":"https://shapkarin.me/articles/structuredClone/","headline":"Deep Cloning in JavaScript: Mastering `structuredClone()`","description":"Learn how to properly create deep copies of complex objects in JavaScript using the modern structuredClone() method, understand its advantages over traditional techniques, and discover when and how to use it effectively.","image":{"@type":"ImageObject","url":"https://shapkarin.me/logo.jpg","width":512,"height":512},"author":{"@type":"Person","name":"Iurii Shapkarin","alternateName":"Yury Shapkarin","url":"https://shapkarin.me"},"publisher":{"@type":"Person","name":"Iurii Shapkarin","alternateName":"Yury Shapkarin","logo":{"@type":"ImageObject","url":"https://shapkarin.me/logo.jpg","width":512,"height":512}},"datePublished":"2025-01-28","dateModified":"2025-01-28","wordCount":"4100","inLanguage":"en-US","proficiencyLevel":["Beginner","Intermediate","Advanced"],"keywords":"structuredClone JavaScript, deep cloning JavaScript, shallow clone deep clone, JavaScript object cloning, copy JavaScript objects, JSON parse stringify alternative, structured clone algorithm, JavaScript deep copy, object copying methods, clone complex objects JavaScript, JavaScript cloning performance, circular references cloning, transferable objects JavaScript, ArrayBuffer cloning, Map Set cloning JavaScript, Date RegExp cloning, JavaScript memory management, object serialization JavaScript, deep clone vs shallow clone, JavaScript data structures cloning, browser API cloning, Web Workers data transfer, JavaScript copying best practices, clone JavaScript arrays, nested object cloning, JavaScript object manipulation, modern JavaScript features, ES2022 JavaScript features, JavaScript performance optimization, clone TypedArray JavaScript, JavaScript memory efficiency, object reference copying, JavaScript immutable data, state management cloning, React state cloning, Redux state cloning, JavaScript functional programming, clone JavaScript primitives, JavaScript object methods, browser compatibility cloning, Node.js cloning, JavaScript data persistence","about":[{"@type":"Thing","name":"Deep Cloning","description":"Creating independent copies of objects where nested objects are recursively copied, preventing shared references between original and copy"},{"@type":"Thing","name":"structuredClone API","description":"Modern JavaScript built-in method for high-fidelity deep cloning using the structured clone algorithm"},{"@type":"Thing","name":"Shallow Cloning","description":"Copying only the top-level properties of an object while nested objects maintain shared references"},{"@type":"Thing","name":"Structured Clone Algorithm","description":"Browser algorithm for copying JavaScript values between contexts, originally developed for Web Workers"},{"@type":"Thing","name":"JavaScript Object Copying","description":"Various techniques and methods for duplicating JavaScript objects and data structures"},{"@type":"Thing","name":"Circular References","description":"Object structures where properties reference back to the parent object, creating circular dependency chains"},{"@type":"Thing","name":"Transferable Objects","description":"JavaScript objects that can transfer ownership of underlying data for efficient memory management"},{"@type":"Thing","name":"JavaScript Performance","description":"Optimization techniques and considerations for efficient JavaScript object manipulation and memory usage"}],"audience":[{"@type":"Audience","audienceType":"Developers","name":"JavaScript Developers"},{"@type":"Audience","audienceType":"Developers","name":"Frontend Developers"},{"@type":"Audience","audienceType":"Developers","name":"Backend Developers"},{"@type":"Audience","audienceType":"Developers","name":"Full-Stack Developers"},{"@type":"Audience","audienceType":"Developers","name":"React Developers"},{"@type":"Audience","audienceType":"Developers","name":"Node.js Developers"},{"@type":"Audience","audienceType":"Students","name":"Computer Science Students"},{"@type":"Audience","audienceType":"Technical Leaders","name":"Software Architects"},{"@type":"Audience","audienceType":"Technical Leaders","name":"Engineering Managers"},{"@type":"Audience","audienceType":"Developers","name":"Web Developers"},{"@type":"Audience","audienceType":"Developers","name":"Software Engineers"},{"@type":"Audience","audienceType":"Students","name":"Programming Students"}],"citation":[{"@type":"WebPage","name":"MDN structuredClone() Documentation","@id":"https://developer.mozilla.org/en-US/docs/Web/API/structuredClone","description":"Official documentation for the structuredClone() method with examples and browser compatibility information","relatedLink":["https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm","https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Transferable_objects","https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse","https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify"]},{"@type":"WebPage","name":"MDN Structured Clone Algorithm","@id":"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm","description":"Comprehensive documentation of the structured clone algorithm and its capabilities and limitations","relatedLink":["https://developer.mozilla.org/en-US/docs/Web/API/Worker/postMessage","https://developer.mozilla.org/en-US/docs/Web/API/MessageChannel","https://developer.mozilla.org/en-US/docs/Web/API/BroadcastChannel","https://developer.mozilla.org/en-US/docs/Web/API/History/pushState"]},{"@type":"WebPage","name":"MDN Transferable Objects","@id":"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Transferable_objects","description":"Documentation on transferable objects and efficient data transfer techniques in JavaScript","relatedLink":["https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer","https://developer.mozilla.org/en-US/docs/Web/API/MessagePort","https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmap","https://developer.mozilla.org/en-US/docs/Web/API/OffscreenCanvas"]},{"@type":"WebPage","name":"MDN JSON.parse() Documentation","@id":"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse","description":"Complete reference for JSON.parse() method and its limitations for object cloning","relatedLink":["https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify","https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON","https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cyclic_object_value"]},{"@type":"WebPage","name":"MDN Object.assign() Documentation","@id":"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign","description":"Documentation for Object.assign() method and shallow cloning techniques","relatedLink":["https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax","https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create","https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys"]},{"@type":"WebPage","name":"WHATWG HTML Living Standard - Structured Clone","@id":"https://html.spec.whatwg.org/multipage/structured-data.html#structured-cloning","description":"Official specification for the structured cloning algorithm used by structuredClone()","relatedLink":["https://html.spec.whatwg.org/multipage/workers.html#dom-worker-postmessage","https://html.spec.whatwg.org/multipage/web-messaging.html#dom-messageport-postmessage","https://html.spec.whatwg.org/multipage/history.html#dom-history-pushstate"]},{"@type":"WebPage","name":"Can I Use structuredClone","@id":"https://caniuse.com/mdn-api_structuredclone","description":"Browser compatibility information for the structuredClone() method across different platforms and versions","relatedLink":["https://caniuse.com/webworkers","https://caniuse.com/messageport","https://caniuse.com/broadcastchannel"]},{"@type":"WebPage","name":"MDN Map Object Documentation","@id":"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map","description":"Complete reference for JavaScript Map objects and their cloning behavior with structuredClone","relatedLink":["https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set","https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakMap","https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakSet"]},{"@type":"WebPage","name":"MDN TypedArray Documentation","@id":"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray","description":"Documentation for TypedArray objects and their cloning capabilities with structuredClone","relatedLink":["https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array","https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float32Array","https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/BigInt64Array"]},{"@type":"WebPage","name":"MDN Date Object Documentation","@id":"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date","description":"Complete reference for JavaScript Date objects and proper cloning techniques","relatedLink":["https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/Date","https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/getTime","https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toISOString"]},{"@type":"WebPage","name":"MDN RegExp Object Documentation","@id":"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp","description":"Documentation for JavaScript RegExp objects and their cloning behavior","relatedLink":["https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions","https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/flags","https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/source"]},{"@type":"WebPage","name":"Lodash cloneDeep Documentation","@id":"https://lodash.com/docs/4.17.15#cloneDeep","description":"Documentation for Lodash's cloneDeep method as an alternative to structuredClone","relatedLink":["https://lodash.com/docs/4.17.15#clone","https://lodash.com/docs/4.17.15#cloneWith","https://lodash.com/docs/4.17.15#cloneDeepWith"]}],"hasPart":[{"@type":"WebPageElement","name":"Shallow vs. Deep Cloning: The Core Difference","url":"https://shapkarin.me/articles/structuredClone#shallow-vs-deep-cloning-the-core-difference","description":"Fundamental explanation of the differences between shallow and deep cloning with practical examples"},{"@type":"WebPageElement","name":"Traditional Deep Cloning Methods and Their Issues","url":"https://shapkarin.me/articles/structuredClone#traditional-deep-cloning-methods-and-their-issues","description":"Analysis of JSON.parse(JSON.stringify()) and recursive cloning approaches with their limitations"},{"@type":"WebPageElement","name":"JSON.parse(JSON.stringify(object)) Method","url":"https://shapkarin.me/articles/structuredClone#1-jsonparsejsonstringifyobject","description":"Detailed examination of the most common traditional cloning method and its data type limitations"},{"@type":"WebPageElement","name":"Recursive Manual Cloning and Third-Party Libraries","url":"https://shapkarin.me/articles/structuredClone#2-recursive-manual-cloning--third-party-libraries","description":"Overview of custom recursive cloning functions and library solutions like Lodash"},{"@type":"WebPageElement","name":"Introducing structuredClone(): The Modern Solution","url":"https://shapkarin.me/articles/structuredClone#introducing-structuredclone-the-modern-solution","description":"Comprehensive introduction to structuredClone() with advanced examples and supported data types"},{"@type":"WebPageElement","name":"Key Benefits of structuredClone()","url":"https://shapkarin.me/articles/structuredClone#key-benefits-of-structuredclone","description":"Detailed analysis of structuredClone advantages including complex type handling and performance"},{"@type":"WebPageElement","name":"Limitations of structuredClone()","url":"https://shapkarin.me/articles/structuredClone#limitations-of-structuredclone","description":"Comprehensive coverage of structuredClone limitations including functions, DOM nodes, and prototypes"},{"@type":"WebPageElement","name":"When to Use structuredClone()","url":"https://shapkarin.me/articles/structuredClone#when-to-use-structuredclone","description":"Best practices and use cases for structuredClone in state management, caching, and Web Workers"},{"@type":"WebPageElement","name":"Conclusion","url":"https://shapkarin.me/articles/structuredClone#conclusion","description":"Summary of structuredClone capabilities and guidance for effective usage in JavaScript projects"}],"teaches":["Understanding the fundamental difference between shallow and deep cloning","Mastering the structuredClone() method for modern JavaScript deep cloning","Recognizing limitations of traditional JSON.parse(JSON.stringify()) approach","Handling complex JavaScript data types like Map, Set, Date, and TypedArrays","Working with circular references in object structures","Optimizing object cloning performance in JavaScript applications","Implementing proper data transfer techniques with Transferable Objects","Choosing appropriate cloning methods based on data type requirements","Understanding structured clone algorithm capabilities and limitations","Best practices for state management and object manipulation","Browser compatibility considerations for modern cloning methods","Memory efficient object copying techniques in JavaScript"],"programmingLanguage":"JavaScript","operatingSystem":"Cross-platform","applicationCategory":"Educational"},{"@context":"https://schema.org","@type":"ImageObject","name":"JavaScript Object Cloning Types Comparison Diagram","description":"Hierarchical diagram comparing shallow copy versus deep copy in JavaScript, showing how references and nested objects are handled differently","contentUrl":"https://shapkarin.me/api/articles/structuredClone-0.svg","encodingFormat":"image/svg+xml","learningResourceType":"diagram","educationalUse":["learning","presentation"],"about":{"@type":"Thing","name":"JavaScript Object Cloning"}},{"@context":"https://schema.org","@type":"ImageObject","name":"structuredClone Benefits and Features Flowchart","description":"Flowchart illustrating the key benefits and features of JavaScript's structuredClone() method including deep copying, circular reference handling, and performance advantages","contentUrl":"https://shapkarin.me/api/articles/structuredClone-1.svg","encodingFormat":"image/svg+xml","learningResourceType":"diagram","educationalUse":["learning","presentation"],"about":{"@type":"Thing","name":"JavaScript structuredClone Method"}},{"@context":"https://schema.org","@type":"FAQPage","mainEntity":[{"@type":"Question","name":"What is the difference between structuredClone() and JSON.parse(JSON.stringify())?","acceptedAnswer":{"@type":"Answer","text":"structuredClone() is far more capable than JSON.parse(JSON.stringify()). While JSON methods can only handle JSON-safe data (losing functions, undefined, Date objects become strings), structuredClone() preserves complex types like Date, RegExp, Map, Set, ArrayBuffer, TypedArrays, and handles circular references. structuredClone() uses the structured clone algorithm for high-fidelity copying, making it the superior choice for deep cloning in modern JavaScript."}},{"@type":"Question","name":"Can structuredClone() clone functions and DOM elements?","acceptedAnswer":{"@type":"Answer","text":"No, structuredClone() cannot clone functions or DOM elements - attempting to do so throws a DataCloneError. Functions are not serializable by the structured clone algorithm, and DOM nodes have special cloning methods like node.cloneNode(). For objects containing functions, you'll need custom cloning solutions or libraries like Lodash's cloneDeep()."}},{"@type":"Question","name":"Does structuredClone() work with circular references?","acceptedAnswer":{"@type":"Answer","text":"Yes, structuredClone() handles circular references perfectly, unlike JSON.parse(JSON.stringify()) which throws an error. When cloning an object with circular references, structuredClone() preserves the circular structure in the new copy, so if original.self === original, then cloned.self === cloned (but cloned.self !== original)."}},{"@type":"Question","name":"What data types can structuredClone() handle?","acceptedAnswer":{"@type":"Answer","text":"structuredClone() supports a wide range of data types: Date, RegExp, Map, Set, ArrayBuffer, all TypedArrays (Uint8Array, Float32Array, etc.), Boolean, Number, String, BigInt, Error objects, ImageData, Blob, File, and more. It handles nested objects and arrays with these types, plus circular references. However, it cannot clone functions, DOM nodes, property descriptors, getters/setters, or prototype chains."}},{"@type":"Question","name":"Is structuredClone() faster than other cloning methods?","acceptedAnswer":{"@type":"Answer","text":"structuredClone() is generally more performant and reliable than JSON.parse(JSON.stringify()) for supported data types, and competitive with library solutions for common use cases. It's implemented natively in browsers, avoiding the serialization overhead of JSON methods. For large objects with complex types, it's typically faster and more memory efficient than manual recursive cloning."}},{"@type":"Question","name":"Can I use structuredClone() to clone custom class instances?","acceptedAnswer":{"@type":"Answer","text":"structuredClone() will clone the data properties of custom class instances, but the result will be a plain object, not an instance of the original class. The prototype chain, methods, and instanceof relationship are lost. If you need to preserve class methods and prototype, you'll need custom cloning logic or libraries that can reconstruct the proper prototype chain."}},{"@type":"Question","name":"What are Transferable Objects with structuredClone()?","acceptedAnswer":{"@type":"Answer","text":"Transferable Objects like ArrayBuffer, MessagePort, or ImageBitmap can transfer ownership of their underlying data instead of copying it, using structuredClone(value, { transfer: [arrayBuffer] }). This is very efficient for large data as it avoids copying - the original object becomes unusable after transfer. This feature is especially useful for Web Worker communication and memory optimization."}},{"@type":"Question","name":"Is structuredClone() supported in all browsers?","acceptedAnswer":{"@type":"Answer","text":"structuredClone() is supported in modern browsers: Chrome 98+, Firefox 94+, Safari 15.4+, and Node.js 17+. For older browser support, you can use polyfills or fallback to library solutions like Lodash's cloneDeep(). Always check browser compatibility requirements for your target audience before using structuredClone()."}},{"@type":"Question","name":"When should I use structuredClone() vs other cloning methods?","acceptedAnswer":{"@type":"Answer","text":"Use structuredClone() for state management, caching, history/undo systems, and Web Worker data transfer when you need high-fidelity cloning of complex data types. Use JSON methods only for simple objects with JSON-safe data. Use libraries like Lodash when you need to clone functions, preserve prototypes, or support older browsers. Choose based on your data types and browser support requirements."}},{"@type":"Question","name":"Can structuredClone() preserve object property descriptors and getters/setters?","acceptedAnswer":{"@type":"Answer","text":"No, structuredClone() only clones property values, not property descriptors, getters, or setters. The cloned object will have plain data properties with values obtained from the original's getters. Property attributes like writable, configurable, and enumerable are not preserved. If you need to preserve property descriptors, you'll need custom cloning logic using Object.getOwnPropertyDescriptor()."}}]},{"@context":"https://schema.org","@type":"HowTo","name":"How to Use structuredClone() for Deep Cloning in JavaScript","description":"Complete guide to implementing structuredClone() for creating deep copies of complex JavaScript objects and data structures","image":{"@type":"ImageObject","url":"https://shapkarin.me/logo.jpg","width":512,"height":512},"totalTime":"PT15M","estimatedCost":{"@type":"MonetaryAmount","currency":"USD","value":"0"},"supply":[{"@type":"HowToSupply","name":"Modern browser with structuredClone() support"},{"@type":"HowToSupply","name":"JavaScript runtime environment"},{"@type":"HowToSupply","name":"Basic understanding of JavaScript objects"}],"tool":[{"@type":"HowToTool","name":"Code editor"},{"@type":"HowToTool","name":"Browser developer console"}],"step":[{"@type":"HowToStep","name":"Check browser compatibility","text":"Verify that your target browsers support structuredClone() (Chrome 98+, Firefox 94+, Safari 15.4+, Node.js 17+). Consider polyfills or fallback methods for older browsers."},{"@type":"HowToStep","name":"Identify objects suitable for structuredClone()","text":"Ensure your object contains supported data types like Date, RegExp, Map, Set, TypedArrays, and basic objects. Avoid objects with functions, DOM elements, or custom class methods that need preservation."},{"@type":"HowToStep","name":"Implement basic structuredClone() usage","text":"Use const cloned = structuredClone(original) to create a deep copy. This handles nested objects, arrays, and complex data types while preserving circular references automatically."},{"@type":"HowToStep","name":"Handle transferable objects for performance","text":"For large ArrayBuffers or ImageBitmaps, use structuredClone(value, { transfer: [arrayBuffer] }) to transfer ownership instead of copying, improving performance for large data sets."},{"@type":"HowToStep","name":"Implement error handling","text":"Wrap structuredClone() in try-catch blocks to handle DataCloneError when attempting to clone unsupported types like functions or DOM elements."},{"@type":"HowToStep","name":"Test with complex data structures","text":"Verify that your cloned objects are independent from originals by modifying nested properties and confirming the original remains unchanged. Test with Maps, Sets, Dates, and circular references."}]},{"@context":"https://schema.org","@type":"HowTo","name":"How to Handle structuredClone() Limitations and Alternatives","description":"Guide to working around structuredClone() limitations and choosing appropriate cloning strategies for different scenarios","image":{"@type":"ImageObject","url":"https://shapkarin.me/logo.jpg","width":512,"height":512},"totalTime":"PT20M","estimatedCost":{"@type":"MonetaryAmount","currency":"USD","value":"0"},"supply":[{"@type":"HowToSupply","name":"Understanding of JavaScript object types"},{"@type":"HowToSupply","name":"Knowledge of alternative cloning libraries"}],"tool":[{"@type":"HowToTool","name":"Lodash library (for alternatives)"},{"@type":"HowToTool","name":"JavaScript development environment"}],"step":[{"@type":"HowToStep","name":"Identify unsupported data types","text":"Check your objects for functions, DOM elements, class methods, getters/setters, or property descriptors that structuredClone() cannot handle. These require alternative approaches."},{"@type":"HowToStep","name":"Implement function-aware cloning","text":"For objects with functions, use Lodash's cloneDeep() or write custom recursive cloning that preserves functions: function cloneWithFunctions(obj) { /* custom logic */ }."},{"@type":"HowToStep","name":"Handle DOM element cloning","text":"Use node.cloneNode(true) for DOM elements instead of structuredClone(). For mixed objects, separate DOM elements and handle them with appropriate methods."},{"@type":"HowToStep","name":"Preserve class instances and prototypes","text":"For custom classes, combine structuredClone() with prototype restoration: const cloned = Object.setPrototypeOf(structuredClone(instance), Object.getPrototypeOf(instance))."},{"@type":"HowToStep","name":"Create hybrid cloning strategy","text":"Develop a cloning function that uses structuredClone() as the primary method but falls back to alternatives for unsupported types, providing comprehensive object cloning."},{"@type":"HowToStep","name":"Test compatibility and performance","text":"Compare your cloning solution with pure structuredClone(), JSON methods, and library solutions. Measure performance and verify correctness with your specific data structures."}]},{"@context":"https://schema.org","@type":"HowTo","name":"How to Migrate from JSON.parse(JSON.stringify()) to structuredClone()","description":"Step-by-step guide to upgrading your deep cloning code from JSON methods to the modern structuredClone() API","image":{"@type":"ImageObject","url":"https://shapkarin.me/logo.jpg","width":512,"height":512},"totalTime":"PT25M","estimatedCost":{"@type":"MonetaryAmount","currency":"USD","value":"0"},"supply":[{"@type":"HowToSupply","name":"Existing codebase using JSON cloning"},{"@type":"HowToSupply","name":"Modern browser support or polyfill"}],"tool":[{"@type":"HowToTool","name":"Code search and replace tools"},{"@type":"HowToTool","name":"Unit testing framework"},{"@type":"HowToTool","name":"Browser compatibility checker"}],"step":[{"@type":"HowToStep","name":"Audit existing JSON cloning usage","text":"Search your codebase for JSON.parse(JSON.stringify()) patterns and identify all locations where deep cloning is performed. Document the data types being cloned at each location."},{"@type":"HowToStep","name":"Analyze data type compatibility","text":"For each cloning location, verify that the data types are compatible with structuredClone(). Check for Date objects that were being incorrectly converted to strings by JSON methods."},{"@type":"HowToStep","name":"Create a migration wrapper function","text":"Write a utility function: function deepClone(obj) { return structuredClone(obj); } with error handling and fallback logic for unsupported browsers or data types."},{"@type":"HowToStep","name":"Replace JSON cloning incrementally","text":"Replace JSON.parse(JSON.stringify(obj)) with your deepClone(obj) function one module at a time. Test each replacement thoroughly to ensure behavior is preserved or improved."},{"@type":"HowToStep","name":"Update tests and fix data type issues","text":"Update unit tests to account for proper type preservation (Date objects remain Dates, not strings). Fix any code that was compensating for JSON method limitations."},{"@type":"HowToStep","name":"Add browser compatibility polyfill","text":"For older browser support, add a structuredClone polyfill or conditional fallback: const deepClone = (obj) => window.structuredClone ? structuredClone(obj) : JSON.parse(JSON.stringify(obj))."},{"@type":"HowToStep","name":"Performance test and optimize","text":"Benchmark the performance improvement from using structuredClone() versus JSON methods. Monitor for any performance regressions and optimize hot paths as needed."}]},{"@context":"https://schema.org","@type":"SoftwareSourceCode","name":"JavaScript structuredClone() Examples and Implementation","description":"Comprehensive code examples demonstrating structuredClone() usage, limitations, and comparison with traditional cloning methods","programmingLanguage":"JavaScript","codeRepository":"https://shapkarin.me/articles/structuredClone","author":{"@type":"Person","name":"Iurii Shapkarin"},"applicationCategory":"Educational","operatingSystem":"Cross-platform","teaches":["structuredClone() basic and advanced usage patterns","Handling complex data types with structured cloning","Working with circular references in object structures","Transferable objects and memory optimization techniques","Error handling for unsupported cloning scenarios","Performance comparisons between different cloning methods","Migration strategies from legacy cloning approaches"]}]</script></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><a href="#menu" class="a11y hidden">Go to Menu</a><div class="About"><a href="/" class="About_greeting">Hello everyone!</a> My name is Iurii Shapkarin. I am a software engineer with over a decade of experience and a solid foundation in Computer Science. My work reflects a firm commitment to innovation, problem-solving, and delivering exceptional user experiences.<a href="https://www.linkedin.com/in/shapkarin" target="_blank" rel="noreferrer" class="Social_Link">LinkedIn<svg fill="none" height="1em" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg></a><a href="https://github.com/shapkarin" target="_blank" rel="noreferrer" class="Social_Link">GitHub<svg fill="none" height="1em" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg></a><span class="About_email">Get my email</span><em class="Disclaimer">Disclaimer: homepage has been gradually developed <a href="https://web.archive.org/web/20130801000000*/shapkarin.me" target="_blank" rel="noreferrer">since 2013<svg fill="none" height="1em" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg></a>with limited time | <a href="https://github.com/shapkarin/shapkarin.me" target="_blank" rel="noreferrer">cource code<svg fill="none" height="1em" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg></a></em></div><nav aria-label="Main Menu" class="Menu" id="menu" role="navigation"><ul class="Menu_List"><li class="Menu_List_Item"><a href="/" class="Menu__Item"><svg fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 22H4C3.44772 22 3 21.5523 3 21V3C3 2.44772 3.44772 2 4 2H20C20.5523 2 21 2.44772 21 3V21C21 21.5523 20.5523 22 20 22ZM19 20V4H5V20H19ZM7 6H11V10H7V6ZM7 12H17V14H7V12ZM7 16H17V18H7V16ZM13 7H17V9H13V7Z"></path></svg> Articles</a></li><li class="Menu_List_Item"><a href="/github/repositories/" class="Menu__Item"><svg fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3 2.75A2.75 2.75 0 0 1 5.75 0h14.5a.75.75 0 0 1 .75.75v20.5a.75.75 0 0 1-.75.75h-6a.75.75 0 0 1 0-1.5h5.25v-4H6A1.5 1.5 0 0 0 4.5 18v.75c0 .716.43 1.334 1.05 1.605a.75.75 0 0 1-.6 1.374A3.251 3.251 0 0 1 3 18.75ZM19.5 1.5H5.75c-.69 0-1.25.56-1.25 1.25v12.651A2.989 2.989 0 0 1 6 15h13.5Z"></path><path d="M7 18.25a.25.25 0 0 1 .25-.25h5a.25.25 0 0 1 .25.25v5.01a.25.25 0 0 1-.397.201l-2.206-1.604a.25.25 0 0 0-.294 0L7.397 23.46a.25.25 0 0 1-.397-.2v-5.01Z"></path></svg> Repositories</a></li><li class="Menu_List_Item"><a href="/github/likes/" class="Menu__Item"><svg fill="currentColor" height="1.2em" stroke="currentColor" stroke-width="0" viewBox="0 0 24 24" width="1.2em" xmlns="http://www.w3.org/2000/svg"><path d="M12 .25a.75.75 0 0 1 .673.418l3.058 6.197 6.839.994a.75.75 0 0 1 .415 1.279l-4.948 4.823 1.168 6.811a.751.751 0 0 1-1.088.791L12 18.347l-6.117 3.216a.75.75 0 0 1-1.088-.79l1.168-6.812-4.948-4.823a.75.75 0 0 1 .416-1.28l6.838-.993L11.328.668A.75.75 0 0 1 12 .25Zm0 2.445L9.44 7.882a.75.75 0 0 1-.565.41l-5.725.832 4.143 4.038a.748.748 0 0 1 .215.664l-.978 5.702 5.121-2.692a.75.75 0 0 1 .698 0l5.12 2.692-.977-5.702a.748.748 0 0 1 .215-.664l4.143-4.038-5.725-.831a.75.75 0 0 1-.565-.41L12 2.694Z"></path></svg> Likes</a></li><li class="Menu_List_Item"><a href="/packages/" class="Menu__Item"><svg fill="currentColor" height="1.24em" stroke="currentColor" stroke-width="0" viewBox="0 0 24 24" width="1.24em" xmlns="http://www.w3.org/2000/svg"><path d="M20.001 3C20.5533 3 21.001 3.44772 21.001 4V20C21.001 20.5523 20.5533 21 20.001 21H4.00098C3.44869 21 3.00098 20.5523 3.00098 20V4C3.00098 3.44772 3.44869 3 4.00098 3H20.001ZM19.001 5H5.00098V19H19.001V5ZM17.001 7V17H14.501V9.5H12.001V17H7.00098V7H17.001Z"></path></svg> Packages</a></li><li class="Menu_List_Item"><a href="/creative/" class="Menu__Item"><svg fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M4 2.99658H20C20.5523 2.99658 21 3.4443 21 3.99658V8.99658C21 9.54887 20.5523 9.99658 20 9.99658H4C3.44772 9.99658 3 9.54887 3 8.99658V3.99658C3 3.4443 3.44772 2.99658 4 2.99658ZM6 11.9966H12C12.5523 11.9966 13 12.4443 13 12.9966V15.9966H14V21.9966H10V15.9966H11V13.9966H5C4.44772 13.9966 4 13.5489 4 12.9966V10.9966H6V11.9966ZM17.7322 13.7288L19.5 11.961L21.2678 13.7288C22.2441 14.7051 22.2441 16.288 21.2678 17.2643C20.2915 18.2407 18.7085 18.2407 17.7322 17.2643C16.7559 16.288 16.7559 14.7051 17.7322 13.7288Z"></path></svg> Creative</a></li></ul><button class="Menu__Item Menu__Item--unselect Menu__Item--bg"><svg fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" viewBox="0 0 512 512" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M433 288.8c-7.7 0-14.3 5.9-14.9 13.6-6.9 83.1-76.8 147.9-161.8 147.9-89.5 0-162.4-72.4-162.4-161.4 0-87.6 70.6-159.2 158.2-161.4 2.3-.1 4.1 1.7 4.1 4v50.3c0 12.6 13.9 20.2 24.6 13.5L377 128c10-6.3 10-20.8 0-27.1l-96.1-66.4c-10.7-6.7-24.6.9-24.6 13.5v45.7c0 2.2-1.7 4-3.9 4C148 99.8 64 184.6 64 288.9 64 394.5 150.1 480 256.3 480c100.8 0 183.4-76.7 191.6-175.1.8-8.7-6.2-16.1-14.9-16.1z"></path></svg> bg upd</button></nav><div class="Wrap"><div class="Page"><a href="/" class="CloseButton" aria-label="Back to the main page"><svg fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" viewBox="0 0 512 512" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M405 136.798L375.202 107 256 226.202 136.798 107 107 136.798 226.202 256 107 375.202 136.798 405 256 285.798 375.202 405 405 375.202 285.798 256z"></path></svg></a><div class="Article Page__Article Page__Inner"><a href="/" class="Article__GoBack">‚Üê All articles</a><div><h2 id="table-of-contents">Table of Contents</h2><ul><li><a href="#shallow-vs-deep-cloning-the-core-difference" target="_self">Shallow vs. Deep Cloning: The Core Difference</a></li><li><a href="#traditional-deep-cloning-methods-and-their-issues" target="_self">Traditional Deep Cloning Methods (and Their Issues)</a><ul><li><a href="#1-jsonparsejsonstringifyobject" target="_self"><code>JSON.parse(JSON.stringify(object))</code></a></li><li><a href="#2-recursive-manual-cloning--third-party-libraries" target="_self">Recursive Manual Cloning / Third-Party Libraries</a></li></ul></li><li><a href="#introducing-structuredclone-the-modern-solution" target="_self">Introducing <code>structuredClone()</code>: The Modern Solution</a><ul><li><a href="#key-benefits-of-structuredclone" target="_self">Key Benefits of <code>structuredClone()</code></a></li></ul></li><li><a href="#limitations-of-structuredclone" target="_self">Limitations of <code>structuredClone()</code></a></li><li><a href="#when-to-use-structuredclone" target="_self">When to Use <code>structuredClone()</code></a></li><li><a href="#conclusion" target="_self">Conclusion</a></li></ul><h1 id="deep-cloning-in-javascript-mastering-structuredclone">Deep Cloning in JavaScript: Mastering <code>structuredClone()</code></h1><p>In JavaScript, copying objects is a common task, but it's not always straightforward. Understanding the difference between shallow and deep cloning is crucial to avoid unintended side effects and bugs in your applications. This article dives into deep cloning, explores traditional methods, and highlights the modern, built-in <code>structuredClone()</code> method.</p><h2 id="shallow-vs-deep-cloning-the-core-difference">Shallow vs. Deep Cloning: The Core Difference</h2><p>When you copy an object in JavaScript, you might be creating either a shallow copy or a deep copy.</p><p><img alt="Graph diagram" src="/api/articles/dark/structuredClone-0.svg"></p><pre><details><summary>Show Mermaid Code</summary><div style='color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e'><code class="language-mermaid" style='white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'><span>    A</span><span class="token text" style="color:#ce9178">[Original Object]</span><span> </span><span class="token" style="color:#569cd6">--></span><span> B</span><span class="token text" style="color:#ce9178">[name: 'Alice']</span><span>
</span><span>    A </span><span class="token" style="color:#569cd6">--></span><span> C</span><span class="token text" style="color:#ce9178">[details: Object Reference]</span><span>
</span><span>    C </span><span class="token" style="color:#569cd6">--></span><span> D</span><span class="token text" style="color:#ce9178">[age: 30]</span><span>
</span>    
<span>    E</span><span class="token text" style="color:#ce9178">[Shallow Copy]</span><span> </span><span class="token" style="color:#569cd6">--></span><span> F</span><span class="token text" style="color:#ce9178">[name: 'Alice']</span><span>
</span><span>    E </span><span class="token" style="color:#569cd6">--></span><span> G</span><span class="token text" style="color:#ce9178">[details: Same Reference]</span><span>
</span><span>    G </span><span class="token" style="color:#569cd6">--></span><span> D
</span>    
<span>    H</span><span class="token text" style="color:#ce9178">[Deep Copy]</span><span> </span><span class="token" style="color:#569cd6">--></span><span> I</span><span class="token text" style="color:#ce9178">[name: 'Alice']</span><span>
</span><span>    H </span><span class="token" style="color:#569cd6">--></span><span> J</span><span class="token text" style="color:#ce9178">[details: New Object]</span><span>
</span><span>    J </span><span class="token" style="color:#569cd6">--></span><span> K</span><span class="token text" style="color:#ce9178">[age: 30]</span><span>
</span>    
<span>    L</span><span class="token text" style="color:#ce9178">[Modify Shallow Copy]</span><span> </span><span class="token" style="color:#569cd6">--></span><span> M</span><span class="token text" style="color:#ce9178">[details.age = 31]</span><span>
</span><span>    M </span><span class="token" style="color:#569cd6">--></span><span> D
</span><span>    M </span><span class="token" style="color:#569cd6">--></span><span> N</span><span class="token text" style="color:#ce9178">[Original Also Changed!]</span><span>
</span>    
<span>    O</span><span class="token text" style="color:#ce9178">[Modify Deep Copy]</span><span> </span><span class="token" style="color:#569cd6">--></span><span> P</span><span class="token text" style="color:#ce9178">[details.age = 31]</span><span>
</span><span>    P </span><span class="token" style="color:#569cd6">--></span><span> K
</span><span>    Q</span><span class="token text" style="color:#ce9178">[Original Unchanged]</span><span> </span><span class="token" style="color:#569cd6">--></span><span> D&lt;/code</span><span class="token text" style="color:#ce9178">>&lt;/pre></span></code></div></details></pre><ul><li><p><strong>Shallow Copy:</strong> Only the top-level properties of an object are copied. If a property holds a reference to another object (like an array or another object), the copy will point to the <em>same</em> referenced object. Modifying the nested object in the copy will also affect the original, and vice-versa.</p><pre><h3 class="Article__CondingLang">javascript:</h3><div style='color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e'><code class="language-javascript" style='white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#569cd6">const</span><span> original </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>  </span><span class="token literal-property" style="color:#9cdcfe">name</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#ce9178">"Alice"</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>  </span><span class="token literal-property" style="color:#9cdcfe">details</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span> </span><span class="token literal-property" style="color:#9cdcfe">age</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#b5cea8">30</span><span> </span><span class="token" style="color:#d4d4d4">}</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#6a9955">// Shallow copy using spread syntax</span><span>
</span><span></span><span class="token" style="color:#569cd6">const</span><span> shallowCopy </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span> </span><span class="token spread" style="color:#d4d4d4">...</span><span>original </span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span>shallowCopy</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">details</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">age</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">31</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>original</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">details</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">age</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// Output: 31 (original is affected!)</span></code></div></pre></li><li><p><strong>Deep Copy:</strong> All properties of the object are copied recursively. This means that if a property is an object, that object is also deeply copied. The new copy is completely independent of the original.</p><pre><h3 class="Article__CondingLang">javascript:</h3><div style='color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e'><code class="language-javascript" style='white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#6a9955">// (Conceptual example, actual deep clone method will be shown later)</span><span>
</span><span></span><span class="token" style="color:#569cd6">const</span><span> original </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>  </span><span class="token literal-property" style="color:#9cdcfe">name</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#ce9178">"Bob"</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>  </span><span class="token literal-property" style="color:#9cdcfe">details</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span> </span><span class="token literal-property" style="color:#9cdcfe">age</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#b5cea8">25</span><span> </span><span class="token" style="color:#d4d4d4">}</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#569cd6">const</span><span> deepCopy </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#dcdcaa">someDeepCloneFunction</span><span class="token" style="color:#d4d4d4">(</span><span>original</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span>deepCopy</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">details</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">age</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">26</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>original</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">details</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">age</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// Output: 25 (original remains unchanged)</span></code></div></pre></li></ul><p>Deep cloning is essential when you need to manipulate a copy of an object without affecting the source, especially in state management, data manipulation, or when working with history (undo/redo functionalities).</p><h2 id="traditional-deep-cloning-methods-and-their-issues">Traditional Deep Cloning Methods (and Their Issues)</h2><p>Before <code>structuredClone()</code>, developers relied on various techniques for deep cloning, each with its own set of limitations.</p><h3 id="1-json-parse-json-stringify-object">1. <code>JSON.parse(JSON.stringify(object))</code></h3><p>This is a common and quick way to deep clone objects that are "JSON-safe" (i.e., can be serialized to a JSON string and then parsed back).</p><pre><h3 class="Article__CondingLang">javascript:</h3><div style='color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e'><code class="language-javascript" style='white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#569cd6">const</span><span> original </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>  </span><span class="token literal-property" style="color:#9cdcfe">name</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#ce9178">"Charlie"</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>  </span><span class="token literal-property" style="color:#9cdcfe">hobbies</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#d4d4d4">[</span><span class="token" style="color:#ce9178">"reading"</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">"hiking"</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>  </span><span class="token literal-property" style="color:#9cdcfe">joined</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#569cd6">new</span><span> </span><span class="token" style="color:#4ec9b0">Date</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">"2023-01-15"</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#569cd6">const</span><span> cloned </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token known-class-name" style="color:#4ec9b0">JSON</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">parse</span><span class="token" style="color:#d4d4d4">(</span><span class="token known-class-name" style="color:#4ec9b0">JSON</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">stringify</span><span class="token" style="color:#d4d4d4">(</span><span>original</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>cloned</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>       </span><span class="token" style="color:#6a9955">// "Charlie"</span><span>
</span><span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>cloned</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">hobbies</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>    </span><span class="token" style="color:#6a9955">// ["reading", "hiking"]</span><span>
</span><span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#569cd6">typeof</span><span> cloned</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">joined</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// "string" (Date object became a string!)</span><span>
</span>
<span>cloned</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">hobbies</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">push</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">"cycling"</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>original</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">hobbies</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>  </span><span class="token" style="color:#6a9955">// ["reading", "hiking"] (hobbies array is deeply cloned)</span></code></div></pre><p><strong>Pros:</strong></p><ul><li>Simple and concise.</li></ul><p><strong>Cons:</strong></p><ul><li><strong>Loses data types:</strong> Functions, <code>undefined</code> values, <code>Symbol</code>s, <code>RegExp</code> objects, <code>Map</code>s, <code>Set</code>s are either lost or incorrectly converted. For example, <code>Date</code> objects are converted to ISO date strings.</li><li>Cannot handle circular references (throws an error).</li><li>Not very performant for large objects.</li></ul><h3 id="2-recursive-manual-cloning-third-party-libraries">2. Recursive Manual Cloning / Third-Party Libraries</h3><p>Developers often wrote custom recursive functions to traverse and clone objects property by property. Libraries like Lodash (<code>_.cloneDeep()</code>) also provide robust deep cloning solutions.</p><p><strong>Pros:</strong></p><ul><li>Can be tailored to handle specific complex types and scenarios.</li><li>Libraries are often well-tested and handle many edge cases.</li></ul><p><strong>Cons:</strong></p><ul><li>Writing a correct and comprehensive manual deep clone function is complex and error-prone.</li><li>Adds a dependency if using a third-party library.</li><li>Can have performance implications.</li></ul><h2 id="introducing-structuredclone-the-modern-solution">Introducing <code>structuredClone()</code>: The Modern Solution</h2><p>JavaScript now has a built-in global function, <code>structuredClone()</code>, designed for high-fidelity deep cloning. It uses the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm" target="_blank">structured clone algorithm</a>, which was originally developed for copying JavaScript values between Web Workers and the main thread.</p><pre><h3 class="Article__CondingLang">javascript:</h3><div style='color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e'><code class="language-javascript" style='white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#569cd6">const</span><span> original </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>  </span><span class="token literal-property" style="color:#9cdcfe">name</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#ce9178">"David"</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>  </span><span class="token literal-property" style="color:#9cdcfe">birthDate</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#569cd6">new</span><span> </span><span class="token" style="color:#4ec9b0">Date</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">"1990-05-20"</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>  </span><span class="token literal-property" style="color:#9cdcfe">regex</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token regex-delimiter" style="color:#d16969">/</span><span class="token regex-source language-regex" style="color:#d16969">pattern</span><span class="token regex-delimiter" style="color:#d16969">/</span><span class="token regex-flags" style="color:#d16969">gi</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>  </span><span class="token literal-property" style="color:#9cdcfe">data</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#569cd6">new</span><span> </span><span class="token" style="color:#4ec9b0">Map</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">[</span><span class="token" style="color:#d4d4d4">[</span><span class="token" style="color:#ce9178">"key1"</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">"value1"</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#d4d4d4">[</span><span class="token" style="color:#ce9178">"key2"</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">"value2"</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>  </span><span class="token literal-property" style="color:#9cdcfe">set</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#569cd6">new</span><span> </span><span class="token" style="color:#4ec9b0">Set</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">[</span><span class="token" style="color:#b5cea8">1</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#b5cea8">2</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#b5cea8">3</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>  </span><span class="token literal-property" style="color:#9cdcfe">typedArr</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#569cd6">new</span><span> </span><span class="token" style="color:#4ec9b0">Uint8Array</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">[</span><span class="token" style="color:#b5cea8">10</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#b5cea8">20</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>  </span><span class="token literal-property" style="color:#9cdcfe">nested</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span> </span><span class="token literal-property" style="color:#9cdcfe">value</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#b5cea8">42</span><span> </span><span class="token" style="color:#d4d4d4">}</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#6a9955">// Add a circular reference</span><span>
</span><span>original</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">self</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> original</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#c586c0">try</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>  </span><span class="token" style="color:#569cd6">const</span><span> cloned </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#dcdcaa">structuredClone</span><span class="token" style="color:#d4d4d4">(</span><span>original</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span>  </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>cloned</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>                </span><span class="token" style="color:#6a9955">// "David"</span><span>
</span><span>  </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>cloned</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">birthDate</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>           </span><span class="token" style="color:#6a9955">// Date object (not a string!)</span><span>
</span><span>  </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>cloned</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">birthDate</span><span> </span><span class="token" style="color:#569cd6">instanceof</span><span> </span><span class="token" style="color:#4ec9b0">Date</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// true</span><span>
</span><span>  </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>cloned</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">regex</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>               </span><span class="token" style="color:#6a9955">// /pattern/gi</span><span>
</span><span>  </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>cloned</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">data</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">get</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">"key1"</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>    </span><span class="token" style="color:#6a9955">// "value1"</span><span>
</span><span>  </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>cloned</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">set</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">has</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#b5cea8">2</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>          </span><span class="token" style="color:#6a9955">// true</span><span>
</span><span>  </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>cloned</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">typedArr</span><span class="token" style="color:#d4d4d4">[</span><span class="token" style="color:#b5cea8">0</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>         </span><span class="token" style="color:#6a9955">// 10</span><span>
</span>
<span>  </span><span class="token" style="color:#6a9955">// Modify the clone</span><span>
</span><span>  cloned</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#ce9178">"David Clone"</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>  cloned</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">birthDate</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">setFullYear</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#b5cea8">1991</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>  cloned</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">data</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">set</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">"key1"</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">"newValue"</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>  cloned</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">nested</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">value</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">100</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span>  </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>original</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>              </span><span class="token" style="color:#6a9955">// "David" (original is unchanged)</span><span>
</span><span>  </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>original</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">birthDate</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">getFullYear</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// 1990 (original is unchanged)</span><span>
</span><span>  </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>original</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">data</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">get</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">"key1"</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>  </span><span class="token" style="color:#6a9955">// "value1" (original is unchanged)</span><span>
</span><span>  </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>original</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">nested</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">value</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>      </span><span class="token" style="color:#6a9955">// 42 (original is unchanged)</span><span>
</span>
<span>  </span><span class="token" style="color:#6a9955">// Check the circular reference</span><span>
</span><span>  </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>cloned</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">self</span><span> </span><span class="token" style="color:#d4d4d4">===</span><span> cloned</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>    </span><span class="token" style="color:#6a9955">// true (circular reference is preserved)</span><span>
</span><span>  </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>cloned</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">self</span><span> </span><span class="token" style="color:#d4d4d4">===</span><span> original</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>  </span><span class="token" style="color:#6a9955">// false (it's a new circular reference within the clone)</span><span>
</span>
<span></span><span class="token" style="color:#d4d4d4">}</span><span> </span><span class="token" style="color:#c586c0">catch</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>error</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>  </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">error</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">"Cloning failed:"</span><span class="token" style="color:#d4d4d4">,</span><span> error</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span></code></div></pre><h3 id="key-benefits-of-structuredclone">Key Benefits of <code>structuredClone()</code>:</h3><p><img alt="Flowchart diagram" src="/api/articles/dark/structuredClone-1.svg"></p><pre><details><summary>Show Mermaid Code</summary><div style='color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e'><code class="language-mermaid" style='white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'><span>    A</span><span class="token text" style="color:#ce9178">[structuredClone]</span><span> </span><span class="token" style="color:#569cd6">--></span><span> B</span><span class="token text" style="color:#ce9178">[Handles Complex Types]</span><span>
</span><span>    A </span><span class="token" style="color:#569cd6">--></span><span> C</span><span class="token text" style="color:#ce9178">[Preserves Circular References]</span><span>
</span><span>    A </span><span class="token" style="color:#569cd6">--></span><span> D</span><span class="token text" style="color:#ce9178">[Better Performance]</span><span>
</span><span>    A </span><span class="token" style="color:#569cd6">--></span><span> E</span><span class="token text" style="color:#ce9178">[Native Browser Support]</span><span>
</span>    
<span>    B </span><span class="token" style="color:#569cd6">--></span><span> F</span><span class="token text" style="color:#ce9178">[Date Objects]</span><span>
</span><span>    B </span><span class="token" style="color:#569cd6">--></span><span> G</span><span class="token text" style="color:#ce9178">[RegExp]</span><span>
</span><span>    B </span><span class="token" style="color:#569cd6">--></span><span> H</span><span class="token text" style="color:#ce9178">[Map & Set]</span><span>
</span><span>    B </span><span class="token" style="color:#569cd6">--></span><span> I</span><span class="token text" style="color:#ce9178">[TypedArrays]</span><span>
</span><span>    B </span><span class="token" style="color:#569cd6">--></span><span> J</span><span class="token text" style="color:#ce9178">[ArrayBuffer]</span><span>
</span>    
<span>    C </span><span class="token" style="color:#569cd6">--></span><span> K</span><span class="token text" style="color:#ce9178">[No Stack Overflow]</span><span>
</span><span>    C </span><span class="token" style="color:#569cd6">--></span><span> L</span><span class="token text" style="color:#ce9178">[Maintains Relationships]</span><span>
</span>    
<span>    D </span><span class="token" style="color:#569cd6">--></span><span> M</span><span class="token text" style="color:#ce9178">[Optimized Algorithm]</span><span>
</span><span>    D </span><span class="token" style="color:#569cd6">--></span><span> N</span><span class="token text" style="color:#ce9178">[No JSON Conversion]</span><span>&lt;/code</span><span class="token text" style="color:#ce9178">>&lt;/pre></span></code></div></details></pre><ul><li><strong>Handles Complex Types:</strong> It can clone a wide variety of JavaScript types beyond what <code>JSON.parse(JSON.stringify())</code> supports, including:<ul><li><code>ArrayBuffer</code></li><li><code>BigInt64Array</code>, <code>BigUint64Array</code></li><li><code>Blob</code></li><li><code>Boolean</code></li><li><code>CryptoKey</code></li><li><code>DataView</code></li><li><code>Date</code></li><li><code>Error</code> types (some properties might be lost, like <code>fileName</code>, <code>lineNumber</code>, <code>columnNumber</code>)</li><li><code>File</code>, <code>FileList</code></li><li><code>Float32Array</code>, <code>Float64Array</code></li><li><code>ImageBitmap</code></li><li><code>ImageData</code></li><li><code>Int8Array</code>, <code>Int16Array</code>, <code>Int32Array</code></li><li><code>Map</code></li><li><code>Number</code></li><li><code>Object</code> (plain objects)</li><li><code>RegExp</code> (though the <code>lastIndex</code> property is not preserved)</li><li><code>Set</code></li><li><code>String</code></li><li><code>Uint8Array</code>, <code>Uint8ClampedArray</code>, <code>Uint16Array</code>, <code>Uint32Array</code></li><li>And more, including WebAssembly modules in supporting environments.</li></ul></li><li><strong>Transfers "Transferable Objects":</strong> For objects like <code>ArrayBuffer</code>, <code>MessagePort</code>, or <code>ImageBitmap</code>, <code>structuredClone()</code> can transfer ownership of the underlying data to the new object if specified via an options argument (e.g., <code>structuredClone(value, { transfer: [arrayBuffer] })</code>). This can be very efficient as it avoids copying large data.</li><li><strong>Handles Circular References:</strong> Unlike <code>JSON.stringify()</code>, <code>structuredClone()</code> can correctly duplicate objects with circular references.</li><li><strong>Performance:</strong> Generally more performant and reliable for supported types compared to <code>JSON.parse(JSON.stringify())</code> and often competitive with library solutions for common use cases.</li></ul><h2 id="limitations-of-structuredclone">Limitations of <code>structuredClone()</code></h2><p>While powerful, <code>structuredClone()</code> is not a silver bullet and has limitations. According to MDN's documentation on the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm#things_that_dont_work_with_structured_clone" target="_blank">structured clone algorithm</a> and the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/structuredClone#exceptions" target="_blank"><code>structuredClone()</code> page</a>, here are key things it <strong>cannot</strong> clone:</p><ol><li><p><strong>Functions:</strong> Attempting to clone an object containing functions will result in a <code>DataCloneError</code>. Functions are not serializable by this algorithm.</p><pre><h3 class="Article__CondingLang">javascript:</h3><div style='color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e'><code class="language-javascript" style='white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#569cd6">const</span><span> objWithFunc </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>  </span><span class="token literal-property" style="color:#9cdcfe">name</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#ce9178">"Test"</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>  </span><span class="token function-variable" style="color:#dcdcaa">greet</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#569cd6">function</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span> </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">"Hello!"</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#d4d4d4">}</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#c586c0">try</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>  </span><span class="token" style="color:#569cd6">const</span><span> cloned </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#dcdcaa">structuredClone</span><span class="token" style="color:#d4d4d4">(</span><span>objWithFunc</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span><span> </span><span class="token" style="color:#c586c0">catch</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>e</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>  </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">error</span><span class="token" style="color:#d4d4d4">(</span><span>e</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span class="token" style="color:#d4d4d4">,</span><span> e</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">message</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// "DataCloneError", "() => { console.log("Hello!"); } could not be cloned."</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span></code></div></pre></li><li><p><strong>DOM Nodes:</strong> DOM elements cannot be cloned using <code>structuredClone()</code>. This will also throw a <code>DataCloneError</code>. If you need to clone DOM nodes, use methods like <code>node.cloneNode(true)</code>.</p><pre><h3 class="Article__CondingLang">javascript:</h3><div style='color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e'><code class="language-javascript" style='white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#569cd6">const</span><span> myDiv </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token dom" style="color:#9cdcfe">document</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">createElement</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">"div"</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>myDiv</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">textContent</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#ce9178">"Hello"</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#c586c0">try</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>  </span><span class="token" style="color:#569cd6">const</span><span> clonedDiv </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#dcdcaa">structuredClone</span><span class="token" style="color:#d4d4d4">(</span><span>myDiv</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span><span> </span><span class="token" style="color:#c586c0">catch</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>e</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>  </span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">error</span><span class="token" style="color:#d4d4d4">(</span><span>e</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span class="token" style="color:#d4d4d4">,</span><span> e</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">message</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// "DataCloneError", "#&lt;HTMLDivElement> could not be cloned." (Exact message may vary by browser)</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span></code></div></pre></li><li><p><strong>Property Descriptors, Setters, and Getters:</strong> The algorithm clones the <em>values</em> of properties. It does not preserve property descriptors (e.g., <code>writable</code>, <code>configurable</code>, <code>enumerable</code>), nor does it duplicate getters and setters. The cloned object will have plain properties with the values obtained from the original's getters.</p><pre><h3 class="Article__CondingLang">javascript:</h3><div style='color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e'><code class="language-javascript" style='white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#569cd6">const</span><span> originalWithAccessor </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>  </span><span class="token literal-property" style="color:#9cdcfe">_privateValue</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#b5cea8">1</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>  </span><span class="token" style="color:#569cd6">get</span><span> </span><span class="token" style="color:#dcdcaa">value</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span> </span><span class="token" style="color:#c586c0">return</span><span> </span><span class="token" style="color:#569cd6">this</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">_privateValue</span><span> </span><span class="token" style="color:#d4d4d4">*</span><span> </span><span class="token" style="color:#b5cea8">2</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>  </span><span class="token" style="color:#569cd6">set</span><span> </span><span class="token" style="color:#dcdcaa">value</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">val</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span> </span><span class="token" style="color:#569cd6">this</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">_privateValue</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> val</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#d4d4d4">}</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token known-class-name" style="color:#4ec9b0">Object</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">defineProperty</span><span class="token" style="color:#d4d4d4">(</span><span>originalWithAccessor</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">'readOnlyProp'</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>    </span><span class="token literal-property" style="color:#9cdcfe">value</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#ce9178">"constant"</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token literal-property" style="color:#9cdcfe">writable</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#569cd6">false</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>

<span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>originalWithAccessor</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">value</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// 2</span><span>
</span>
<span></span><span class="token" style="color:#569cd6">const</span><span> clonedAccessor </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#dcdcaa">structuredClone</span><span class="token" style="color:#d4d4d4">(</span><span>originalWithAccessor</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>clonedAccessor</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">value</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// 2 (the result of the getter is cloned as a data property)</span><span>
</span><span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span class="token known-class-name" style="color:#4ec9b0">Object</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">getOwnPropertyDescriptor</span><span class="token" style="color:#d4d4d4">(</span><span>clonedAccessor</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">'value'</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#6a9955">// { value: 2, writable: true, enumerable: true, configurable: true }</span><span>
</span><span></span><span class="token" style="color:#6a9955">// The getter/setter is gone, 'value' is now a simple data property.</span><span>
</span>
<span>clonedAccessor</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">value</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">10</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// This changes clonedAccessor._privateValue (if it were cloned) or clonedAccessor.value directly</span><span>
</span><span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>clonedAccessor</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">value</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// 10</span><span>
</span><span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>originalWithAccessor</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">value</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// 2 (original is unaffected, which is good)</span><span>
</span>
<span></span><span class="token" style="color:#569cd6">const</span><span> desc </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token known-class-name" style="color:#4ec9b0">Object</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">getOwnPropertyDescriptor</span><span class="token" style="color:#d4d4d4">(</span><span>clonedAccessor</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">'readOnlyProp'</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>desc</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">writable</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// true - was false on original</span></code></div></pre></li><li><p><strong>Object Prototypes:</strong> The prototype chain is not traversed or duplicated. The cloned object will always be a plain object or an instance of a built-in type (like <code>Date</code>, <code>Map</code>, etc.). If you clone an instance of a custom class, the clone will be a plain object, and it will not be an <code>instanceof</code> your custom class, nor will it inherit methods from the class prototype.</p><pre><h3 class="Article__CondingLang">javascript:</h3><div style='color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e'><code class="language-javascript" style='white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#569cd6">class</span><span> </span><span class="token" style="color:#4ec9b0">MyClass</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>  </span><span class="token" style="color:#dcdcaa">constructor</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">name</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>    </span><span class="token" style="color:#569cd6">this</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> name</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>  </span><span class="token" style="color:#d4d4d4">}</span><span>
</span><span>  </span><span class="token" style="color:#dcdcaa">greet</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>    </span><span class="token" style="color:#c586c0">return</span><span> </span><span class="token template-string template-punctuation" style="color:#ce9178">`</span><span class="token template-string" style="color:#ce9178">Hello, </span><span class="token template-string" style="color:#569cd6">${</span><span class="token template-string" style="color:#569cd6">this</span><span class="token template-string" style="color:#d4d4d4">.</span><span class="token template-string property-access" style="color:#9cdcfe">name</span><span class="token template-string" style="color:#569cd6">}</span><span class="token template-string template-punctuation" style="color:#ce9178">`</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>  </span><span class="token" style="color:#d4d4d4">}</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span><span>
</span>
<span></span><span class="token" style="color:#569cd6">const</span><span> myInstance </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#569cd6">new</span><span> </span><span class="token" style="color:#4ec9b0">MyClass</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">"Eve"</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>myInstance</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">greet</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>      </span><span class="token" style="color:#6a9955">// "Hello, Eve"</span><span>
</span><span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>myInstance </span><span class="token" style="color:#569cd6">instanceof</span><span> </span><span class="token" style="color:#4ec9b0">MyClass</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// true</span><span>
</span>
<span></span><span class="token" style="color:#569cd6">const</span><span> clonedInstance </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#dcdcaa">structuredClone</span><span class="token" style="color:#d4d4d4">(</span><span>myInstance</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>clonedInstance</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>     </span><span class="token" style="color:#6a9955">// "Eve"</span><span>
</span><span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>clonedInstance </span><span class="token" style="color:#569cd6">instanceof</span><span> </span><span class="token" style="color:#4ec9b0">MyClass</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// false</span><span>
</span><span></span><span class="token" style="color:#6a9955">// console.log(clonedInstance.greet()); // TypeError: clonedInstance.greet is not a function</span></code></div></pre></li><li><p><strong>Other Non-Serializable Objects:</strong> Certain built-in types like <code>WeakMap</code>, <code>WeakSet</code>, and some platform-specific objects might not be cloneable. The exact list can be nuanced and environment-dependent. Always refer to the latest MDN documentation.</p></li></ol><h2 id="when-to-use-structuredclone">When to Use <code>structuredClone()</code></h2><p><code>structuredClone()</code> is an excellent choice for many deep cloning scenarios:</p><ul><li><strong>State Management:</strong> Safely duplicating state objects in frameworks like Redux, Vuex, or when managing component state.</li><li><strong>Caching or Memoization:</strong> Storing copies of complex data structures.</li><li><strong>History (Undo/Redo):</strong> Creating snapshots of application data.</li><li><strong>Web Workers:</strong> Passing complex data to and from workers without accidentally sharing memory (unless using <code>Transferable</code> objects explicitly).</li><li>When you need to clone common JavaScript objects and data structures like Dates, RegExps, Maps, Sets, TypedArrays, and even those with circular references, without the data loss issues of <code>JSON.parse(JSON.stringify())</code>.</li></ul><p>However, if you need to:</p><ul><li>Clone functions.</li><li>Clone DOM nodes.</li><li>Preserve the full prototype chain of custom class instances (including methods).</li><li>Preserve property descriptors, getters, or setters.</li><li>Handle specific object types not supported by the structured clone algorithm.</li></ul><p>...then you'll still need to resort to custom cloning functions or established libraries like Lodash's <code>_.cloneDeep()</code>.</p><h2 id="conclusion">Conclusion</h2><p>The <code>structuredClone()</code> method is a significant addition to JavaScript, providing a robust, built-in mechanism for deep cloning a wide array of data types. It addresses many of the shortcomings of older techniques like <code>JSON.parse(JSON.stringify())</code>, especially regarding type fidelity and handling circular references.</p><p>While it has limitations, particularly with functions and DOM nodes, <code>structuredClone()</code> simplifies many common deep cloning tasks, leading to cleaner, more reliable code. Understanding its capabilities and limitations, as outlined on MDN (<a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/structuredClone" target="_blank">Window.structuredClone()</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm" target="_blank">Structured clone algorithm</a>), is key to leveraging it effectively in your JavaScript projects.</p></div></div></div></div><footer class="Footer">The API for this site <a href="https://github.com/shapkarin/shapkarin.me/tree/master/src/Generate-Backend" target="_blank" rel="noreferrer">is generated</a><svg fill="none" height="1em" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg> and stored as <a href="https://github.com/shapkarin/shapkarin.me/tree/gh-@/Pages/api" target="_blank" rel="noreferrer">JSON and Markdown</a><svg fill="none" height="1em" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg> on GitHub Pages.<br>It <a href="https://github.com/shapkarin/shapkarin.me/blob/main/.github/workflows/build-deploy.yml" target="_blank" rel="noreferrer">uses Github Actions<svg fill="none" height="1em" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg></a>to help with CI and generates a static version.</footer></div><canvas height="850" id="background" width="480"></canvas></body></html>