<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><link href="/favicon/favicon-96x96.png" rel="icon" sizes="96x96" type="image/png"><link href="/favicon/favicon.svg" rel="icon" type="image/svg+xml"><link href="/favicon/favicon.ico" rel="shortcut icon"><link href="/favicon/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180"><meta content="shapkarin.me" name="apple-mobile-web-app-title"><link href="/favicon/site.webmanifest" rel="manifest"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="#000000" name="theme-color"><title>Floating-Point Precision: Why 0.1 + 0.2 Isn't 0.3 | Yuri Shapkarin</title><meta content="Yuri Shapkarin's personal website" name="description"><script type="text/javascript">!function(){"use strict";!function(){const e=window.location;let t=e.pathname;if(e.pathname.endsWith("//")&&(t=e.pathname.replace(/\/+$/,"/")||"/",console.log("Normalized double trailing slash:",t+e.search+e.hash)),t!==e.pathname){var a=document.createElement("link");a.setAttribute("rel","canonical"),a.setAttribute("href",t),document.head.appendChild(a),window.location.replace(t+e.search+e.hash)}}()}()</script><meta content="website" property="og:type"><meta content="Yuri Shapkarin | Software Developer" property="og:title"><meta content="Yuri Shapkarin's personal website" property="og:description"><meta content="https://shapkarin.me" property="og:url"><meta content="Yuri Shapkarin" name="twitter:creator"><meta content="website" name="twitter:card"><meta content="Yuri Shapkarin | Software Developer" name="twitter:title"><meta content="Yuri Shapkarin's personal website" name="twitter:description"><link href="https://fonts.googleapis.com/css?family=Lato:300" rel="stylesheet"><title>Yuri Shapkarin</title><link href="https://fonts.googleapis.com" rel="preconnect"><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin=""><link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet"><script defer src="/static/js/main.b4980af7.js"></script><link href="/static/css/main.2a84e15d.css" rel="stylesheet"><link href="https://fonts.googleapis.com" rel="preconnect"><link href="https://fonts.gstatic.com" rel="preconnect"><link href="https://raw.githubusercontent.com" rel="preconnect"><link href="https://shapkarin.me/articles/floating-point-precision/" rel="canonical" data-react-helmet="true"><meta content="Explore the surprising result of 0.1 + 0.2 in programming and understand why it happens due to floating-point representation and the IEEE 754 standard." name="description" data-react-helmet="true"><meta content="" name="keywords" data-react-helmet="true"><meta content="article" data-react-helmet="true" property="og:type"><meta content="Floating-Point Precision: Why 0.1 + 0.2 Isn't 0.3 | Yuri Shapkarin" data-react-helmet="true" property="og:title"><meta content="Explore the surprising result of 0.1 + 0.2 in programming and understand why it happens due to floating-point representation and the IEEE 754 standard." data-react-helmet="true" property="og:description"><meta content="https://shapkarin.me/articles/floating-point-precision/" data-react-helmet="true" property="og:url"><meta content="Yuri Shapkarin" name="twitter:creator" data-react-helmet="true"><meta content="article" name="twitter:card" data-react-helmet="true"><meta content="Floating-Point Precision: Why 0.1 + 0.2 Isn't 0.3 | Yuri Shapkarin" name="twitter:title" data-react-helmet="true"><meta content="Explore the surprising result of 0.1 + 0.2 in programming and understand why it happens due to floating-point representation and the IEEE 754 standard." name="twitter:description" data-react-helmet="true"><script type="application/ld+json" data-react-helmet="true">[{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://shapkarin.me/articles/floating-point-precision/"},"url":"https://shapkarin.me/articles/floating-point-precision/","headline":"Floating-Point Precision: Why 0.1 + 0.2 Isn't 0.3 - Complete Developer Guide","description":"Discover why 0.1 + 0.2 equals 0.30000000000000004 in programming. Learn IEEE 754 standard, binary representation issues, and practical solutions for JavaScript, Python, C++, and Rust with expert examples.","image":{"@type":"ImageObject","url":"https://shapkarin.me/logo.jpg","width":512,"height":512},"author":{"@type":"Person","name":"Yuri Shapkarin","alternateName":"Iurii Shapkarin","url":"https://shapkarin.me"},"publisher":{"@type":"Person","name":"Yuri Shapkarin","alternateName":"Iurii Shapkarin","logo":{"@type":"ImageObject","url":"https://shapkarin.me/logo.jpg","width":512,"height":512}},"datePublished":"2023-09-20","dateModified":"2024-02-15","wordCount":"1850","inLanguage":"en-US","learningResourceType":"Technical tutorial","proficiencyLevel":["Beginner","Intermediate","Advanced"],"keywords":"floating point precision, 0.1 + 0.2, IEEE 754, binary representation, JavaScript floating point, Python decimal precision, C++ double precision, Rust f64, floating point errors, computer arithmetic, binary fractions, decimal arithmetic, BigInt JavaScript, financial calculations, programming mathematics","about":[{"@type":"Thing","name":"IEEE 754","description":"IEEE Standard for Floating-Point Arithmetic defining binary and decimal floating-point formats"},{"@type":"Thing","name":"Floating-point arithmetic","description":"Computer representation and manipulation of real numbers in binary format"},{"@type":"Thing","name":"Binary representation","description":"How computers store decimal numbers in base-2 binary format"},{"@type":"Thing","name":"JavaScript Number precision"},{"@type":"Thing","name":"Computer Mathematics"}],"audience":[{"@type":"Audience","audienceType":"Students","name":"Computer Science Students"},{"@type":"Audience","audienceType":"Developers","name":"Full-Stack Developers"},{"@type":"Audience","audienceType":"Developers","name":"React Developers"},{"@type":"Audience","audienceType":"Technical Leaders","name":"Software Architects"},{"@type":"Audience","audienceType":"Technical Leaders","name":"Engineering Managers"},{"@type":"Audience","audienceType":"Business Professionals","name":"Chief Technology Officers (CTOs)"},{"@type":"Audience","audienceType":"Developers","name":"Software Engineers"}],"citation":[{"@type":"WebPage","name":"IEEE 754 Standard","@id":"https://standards.ieee.org/standard/754-2019.html"},{"@type":"WebPage","name":"JavaScript Number documentation","@id":"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number"},{"@type":"WebPage","name":"Python decimal module","@id":"https://docs.python.org/3/library/decimal.html"},{"@type":"WebPage","name":"Floating Point Arithmetic: Issues and Limitations","@id":"https://docs.python.org/3/tutorial/floatingpoint.html"},{"@type":"WebPage","name":"What Every Computer Scientist Should Know About Floating-Point Arithmetic","@id":"https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html"}],"hasPart":[{"@type":"WebPageElement","name":"Why 0.1 + 0.2 Isn't Exactly 0.3 in Most Programming Languages","url":"https://shapkarin.me/articles/floating-point-precision#why-0-1-0-2-isn-t-exactly-0-3-in-most-programming-languages"},{"@type":"WebPageElement","name":"The Root Cause: Binary Representation","url":"https://shapkarin.me/articles/floating-point-precision#the-root-cause-binary-representation"},{"@type":"WebPageElement","name":"Adding the Inexact Values","url":"https://shapkarin.me/articles/floating-point-precision#adding-the-inexact-values"},{"@type":"WebPageElement","name":"The Role of IEEE 754","url":"https://shapkarin.me/articles/floating-point-precision#the-role-of-ieee-754"},{"@type":"WebPageElement","name":"Demonstrations in Code","url":"https://shapkarin.me/articles/floating-point-precision#demonstrations-in-code"},{"@type":"WebPageElement","name":"Why it Matters and How to Handle It","url":"https://shapkarin.me/articles/floating-point-precision#why-it-matters-and-how-to-handle-it"}],"teaches":["Why 0.1 + 0.2 equals 0.30000000000000004 in programming languages","How binary representation causes floating-point precision errors","Understanding IEEE 754 standard and rounding rules","Practical solutions for exact decimal arithmetic","When and how to use BigInt in JavaScript for precision","Best practices for financial calculations in programming","Cross-language floating-point behavior in JavaScript, Python, C++, and Rust"],"programmingLanguage":["JavaScript","Python","C++","Rust"],"operatingSystem":"Cross-platform","applicationCategory":"Educational"},{"@context":"https://schema.org","@type":"ImageObject","name":"Floating-Point Binary Conversion and Precision Error Diagram","description":"Flowchart illustrating how decimal numbers 0.1 and 0.2 are converted to binary representation, rounded to fit 64-bit format, and how their addition results in precision errors leading to 0.30000000000000004","contentUrl":"https://shapkarin.me/api/articles/floating-point-precision-0.svg","encodingFormat":"image/svg+xml","learningResourceType":"diagram","educationalUse":["learning","presentation"],"about":{"@type":"Thing","name":"IEEE 754 Floating-Point Representation"}},{"@context":"https://schema.org","@type":"FAQPage","mainEntity":[{"@type":"Question","name":"Why does 0.1 + 0.2 equal 0.30000000000000004 instead of 0.3?","acceptedAnswer":{"@type":"Answer","text":"This happens because computers store decimal numbers in binary format, and many decimal fractions like 0.1 and 0.2 cannot be represented exactly in binary. They are stored as the closest possible binary approximation, and when added together, the result is slightly off from the expected decimal value due to accumulated rounding errors."}},{"@type":"Question","name":"What is IEEE 754 and how does it affect floating-point precision?","acceptedAnswer":{"@type":"Answer","text":"IEEE 754 is the technical standard for floating-point arithmetic used by most computers and programming languages. It defines how floating-point numbers are represented in binary, including the format for single-precision (32-bit) and double-precision (64-bit) numbers, and the rules for arithmetic operations and rounding. This standard ensures consistent floating-point behavior across different platforms but also introduces the precision limitations we observe."}},{"@type":"Question","name":"How can I fix floating-point precision errors in my code?","acceptedAnswer":{"@type":"Answer","text":"There are several solutions: 1) Use dedicated decimal libraries (like Python's decimal module or JavaScript's decimal.js), 2) Work with integers by scaling your numbers (e.g., use cents instead of dollars), 3) Use epsilon comparisons instead of exact equality checks, 4) For JavaScript, consider using BigInt for large integer calculations, or 5) Round results to a specific number of decimal places when displaying to users."}},{"@type":"Question","name":"Do all programming languages have this floating-point precision issue?","acceptedAnswer":{"@type":"Answer","text":"Yes, any programming language that uses IEEE 754 floating-point arithmetic (which includes JavaScript, Python, C++, Java, C#, Rust, and most others) will exhibit this behavior. The issue is not language-specific but rather a fundamental characteristic of how binary floating-point numbers work in computer hardware."}},{"@type":"Question","name":"When should I be concerned about floating-point precision errors?","acceptedAnswer":{"@type":"Answer","text":"You should be most concerned when dealing with: 1) Financial calculations where exact decimal precision is legally required, 2) Equality comparisons between floating-point numbers, 3) Iterative calculations where small errors can accumulate over time, 4) Scientific computations requiring high precision, or 5) Any application where users might notice or be affected by small numerical discrepancies."}},{"@type":"Question","name":"What is the difference between single-precision and double-precision floating-point?","acceptedAnswer":{"@type":"Answer","text":"Single-precision (32-bit) floating-point numbers have about 7 decimal digits of precision, while double-precision (64-bit) numbers have about 15-16 decimal digits of precision. Most programming languages use double-precision by default (like JavaScript's Number type, Python's float, C++'s double). Single-precision uses less memory but sacrifices accuracy, while double-precision provides better accuracy at the cost of more memory usage."}},{"@type":"Question","name":"How does JavaScript's BigInt help with precision issues?","acceptedAnswer":{"@type":"Answer","text":"BigInt in JavaScript provides arbitrary precision integer arithmetic, allowing you to work with integers larger than Number.MAX_SAFE_INTEGER (2^53 - 1) without losing precision. While BigInt doesn't directly solve floating-point decimal issues, it's useful when you can scale your problem to work with integers (like converting dollars to cents) to avoid floating-point arithmetic altogether."}}]},{"@context":"https://schema.org","@type":"HowTo","name":"How to Handle Floating-Point Precision Issues in Programming","description":"Step-by-step guide to identifying, understanding, and solving floating-point precision problems in software development","image":{"@type":"ImageObject","url":"https://shapkarin.me/logo.jpg","width":512,"height":512},"totalTime":"PT20M","estimatedCost":{"@type":"MonetaryAmount","currency":"USD","value":"0"},"supply":[{"@type":"HowToSupply","name":"Programming environment"},{"@type":"HowToSupply","name":"Code editor or IDE"}],"tool":[{"@type":"HowToTool","name":"JavaScript console or Python REPL"},{"@type":"HowToTool","name":"Decimal arithmetic library"}],"step":[{"@type":"HowToStep","name":"Identify floating-point precision issues","text":"Test your calculations with simple decimal operations like 0.1 + 0.2 and check if the results match your expectations exactly"},{"@type":"HowToStep","name":"Understand the root cause","text":"Learn that decimal fractions often cannot be represented exactly in binary floating-point format, leading to small rounding errors"},{"@type":"HowToStep","name":"Choose appropriate solution","text":"Select from: decimal libraries for exact arithmetic, integer scaling for fixed-point math, epsilon comparisons for equality checks, or rounding for display purposes"},{"@type":"HowToStep","name":"Implement the solution","text":"Apply your chosen method consistently throughout your codebase, especially in critical calculations like financial transactions"},{"@type":"HowToStep","name":"Test and validate","text":"Verify that your solution produces the expected results and handles edge cases appropriately"}]},{"@context":"https://schema.org","@type":"SoftwareSourceCode","name":"Floating-Point Precision Examples","description":"Code examples demonstrating floating-point precision issues and solutions across multiple programming languages","programmingLanguage":["JavaScript","Python","C++","Rust"],"codeRepository":"https://shapkarin.me/articles/floating-point-precision","author":{"@type":"Person","name":"Yuri Shapkarin"},"applicationCategory":"Educational","operatingSystem":"Cross-platform"}]</script></head><body><div id="root"><a href="#menu" class="a11y hidden">Go to Menu</a><div class="About"><a href="/" class="About_greeting">Hello everyone!</a> My name is Yuri Shapkarin. I am a software engineer with over a decade of experience and a solid foundation in Computer Science. My work reflects a firm commitment to innovation, problem-solving, and delivering exceptional user experiences.<a href="https://www.linkedin.com/in/shapkarin" target="_blank" rel="noreferrer" class="Social_Link">LinkedIn<svg fill="none" height="12" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="12" xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round" style="margin-left:2px"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg></a><a href="https://github.com/shapkarin" target="_blank" rel="noreferrer" class="Social_Link">GitHub<svg fill="none" height="12" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="12" xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round" style="margin-left:2px"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg></a><span class="About_email">Get my email</span><em class="Disclaimer">Disclaimer: homepage has been gradually developed <a href="https://web.archive.org/web/20130801000000*/shapkarin.me" target="_blank" rel="noreferrer">since 2013<svg fill="none" height="12" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="12" xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round" style="margin-left:2px"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg></a>with limited time | <a href="https://github.com/shapkarin/shapkarin.me" target="_blank" rel="noreferrer">cource code<svg fill="none" height="12" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="12" xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round" style="margin-left:2px"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg></a></em></div><nav aria-label="Main Menu" class="Menu" id="menu" role="navigation"><ul class="Menu_List"><li class="Menu_List_Item"><a href="/articles/" class="Menu__Item"><svg fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 22H4C3.44772 22 3 21.5523 3 21V3C3 2.44772 3.44772 2 4 2H20C20.5523 2 21 2.44772 21 3V21C21 21.5523 20.5523 22 20 22ZM19 20V4H5V20H19ZM7 6H11V10H7V6ZM7 12H17V14H7V12ZM7 16H17V18H7V16ZM13 7H17V9H13V7Z"></path></svg> Articles</a></li><li class="Menu_List_Item"><a href="/github/repositories/" class="Menu__Item"><svg fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3 2.75A2.75 2.75 0 0 1 5.75 0h14.5a.75.75 0 0 1 .75.75v20.5a.75.75 0 0 1-.75.75h-6a.75.75 0 0 1 0-1.5h5.25v-4H6A1.5 1.5 0 0 0 4.5 18v.75c0 .716.43 1.334 1.05 1.605a.75.75 0 0 1-.6 1.374A3.251 3.251 0 0 1 3 18.75ZM19.5 1.5H5.75c-.69 0-1.25.56-1.25 1.25v12.651A2.989 2.989 0 0 1 6 15h13.5Z"></path><path d="M7 18.25a.25.25 0 0 1 .25-.25h5a.25.25 0 0 1 .25.25v5.01a.25.25 0 0 1-.397.201l-2.206-1.604a.25.25 0 0 0-.294 0L7.397 23.46a.25.25 0 0 1-.397-.2v-5.01Z"></path></svg> Repositories</a></li><li class="Menu_List_Item"><a href="/github/likes/" class="Menu__Item"><svg fill="currentColor" height="1.2em" stroke="currentColor" stroke-width="0" viewBox="0 0 24 24" width="1.2em" xmlns="http://www.w3.org/2000/svg"><path d="M12 .25a.75.75 0 0 1 .673.418l3.058 6.197 6.839.994a.75.75 0 0 1 .415 1.279l-4.948 4.823 1.168 6.811a.751.751 0 0 1-1.088.791L12 18.347l-6.117 3.216a.75.75 0 0 1-1.088-.79l1.168-6.812-4.948-4.823a.75.75 0 0 1 .416-1.28l6.838-.993L11.328.668A.75.75 0 0 1 12 .25Zm0 2.445L9.44 7.882a.75.75 0 0 1-.565.41l-5.725.832 4.143 4.038a.748.748 0 0 1 .215.664l-.978 5.702 5.121-2.692a.75.75 0 0 1 .698 0l5.12 2.692-.977-5.702a.748.748 0 0 1 .215-.664l4.143-4.038-5.725-.831a.75.75 0 0 1-.565-.41L12 2.694Z"></path></svg> Likes</a></li><li class="Menu_List_Item"><a href="/packages/" class="Menu__Item"><svg fill="currentColor" height="1.24em" stroke="currentColor" stroke-width="0" viewBox="0 0 24 24" width="1.24em" xmlns="http://www.w3.org/2000/svg"><path d="M20.001 3C20.5533 3 21.001 3.44772 21.001 4V20C21.001 20.5523 20.5533 21 20.001 21H4.00098C3.44869 21 3.00098 20.5523 3.00098 20V4C3.00098 3.44772 3.44869 3 4.00098 3H20.001ZM19.001 5H5.00098V19H19.001V5ZM17.001 7V17H14.501V9.5H12.001V17H7.00098V7H17.001Z"></path></svg> Packages</a></li><li class="Menu_List_Item"><a href="/creative/" class="Menu__Item"><svg fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M4 2.99658H20C20.5523 2.99658 21 3.4443 21 3.99658V8.99658C21 9.54887 20.5523 9.99658 20 9.99658H4C3.44772 9.99658 3 9.54887 3 8.99658V3.99658C3 3.4443 3.44772 2.99658 4 2.99658ZM6 11.9966H12C12.5523 11.9966 13 12.4443 13 12.9966V15.9966H14V21.9966H10V15.9966H11V13.9966H5C4.44772 13.9966 4 13.5489 4 12.9966V10.9966H6V11.9966ZM17.7322 13.7288L19.5 11.961L21.2678 13.7288C22.2441 14.7051 22.2441 16.288 21.2678 17.2643C20.2915 18.2407 18.7085 18.2407 17.7322 17.2643C16.7559 16.288 16.7559 14.7051 17.7322 13.7288Z"></path></svg> Creative</a></li></ul><button class="Menu__Item Menu__Item--unselect Menu__Item--bg"><svg fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" viewBox="0 0 512 512" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M433 288.8c-7.7 0-14.3 5.9-14.9 13.6-6.9 83.1-76.8 147.9-161.8 147.9-89.5 0-162.4-72.4-162.4-161.4 0-87.6 70.6-159.2 158.2-161.4 2.3-.1 4.1 1.7 4.1 4v50.3c0 12.6 13.9 20.2 24.6 13.5L377 128c10-6.3 10-20.8 0-27.1l-96.1-66.4c-10.7-6.7-24.6.9-24.6 13.5v45.7c0 2.2-1.7 4-3.9 4C148 99.8 64 184.6 64 288.9 64 394.5 150.1 480 256.3 480c100.8 0 183.4-76.7 191.6-175.1.8-8.7-6.2-16.1-14.9-16.1z"></path></svg> bg upd</button></nav><div class="Wrap"><div class="Page"><a href="/" class="CloseButton" aria-label="Back to the main page" style=""><svg fill="currentColor" height="1em" stroke="currentColor" stroke-width="0" viewBox="0 0 512 512" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M405 136.798L375.202 107 256 226.202 136.798 107 107 136.798 226.202 256 107 375.202 136.798 405 256 285.798 375.202 405 405 375.202 285.798 256z"></path></svg></a><div class="Article Page__Article Page__Inner"><a href="/articles/" class="Article__GoBack">‚Üê All articles</a><div><h1 id="computer-floating-point-precision">Computer Floating-Point Precision</h1><h2 id="table-of-contents">Table of Contents</h2><ul><li><a href="#why-0-1-0-2-isn-t-exactly-0-3-in-most-programming-languages" target="_self">Why 0.1 + 0.2 Isn't Exactly 0.3 in Most Programming Languages</a></li><li><a href="#the-root-cause-binary-representation" target="_self">The Root Cause: Binary Representation</a></li><li><a href="#adding-the-inexact-values" target="_self">Adding the Inexact Values</a></li><li><a href="#the-role-of-ieee-754" target="_self">The Role of IEEE 754</a></li><li><a href="#demonstrations-in-code" target="_self">Demonstrations in Code</a></li><li><a href="#why-it-matters-and-how-to-handle-it" target="_self">Why it Matters and How to Handle It</a></li></ul><h1 id="why-0-1-0-2-isn-t-exactly-0-3-in-most-programming-languages">Why 0.1 + 0.2 Isn't Exactly 0.3 in Most Programming Languages</h1><p>As a software engineer with over a decade of experience, one of the fundamental concepts that often surprises newcomers (and sometimes even catches seasoned developers off guard) is the behavior of floating-point arithmetic. You might expect a simple addition like <code>0.1 + 0.2</code> to result in <code>0.3</code>. However, in many programming languages and environments, the result is slightly different: <code>0.30000000000000004</code>.</p><h2 id="the-root-cause-binary-representation">The Root Cause: Binary Representation</h2><p>Computers store numbers using binary (base 2). Integers are straightforward, but representing fractional numbers in binary can be tricky. While some decimal fractions, like 0.5 (which is <code>0.1</code> in binary), can be represented exactly, many others cannot.</p><p><img alt="Graph diagram" src="/api/articles/light/floating-point-precision-0.svg"></p><pre><details><summary>Show Mermaid Code</summary><div style='color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e'><code class="language-mermaid" style='white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#569cd6">graph</span><span> TD
</span><span>    A</span><span class="token text" style="color:#ce9178">[Decimal Number 0.1]</span><span> </span><span class="token" style="color:#569cd6">--></span><span> B</span><span class="token text" style="color:#ce9178">[Convert to Binary]</span><span>
</span><span>    B </span><span class="token" style="color:#569cd6">--></span><span> C</span><span class="token text" style="color:#ce9178">[0.0001100110011...]</span><span>
</span><span>    C </span><span class="token" style="color:#569cd6">--></span><span> D</span><span class="token text" style="color:#ce9178">[Infinite Binary Representation]</span><span>
</span><span>    D </span><span class="token" style="color:#569cd6">--></span><span> E</span><span class="token text" style="color:#ce9178">[Must Round to Fit 64-bit]</span><span>
</span><span>    E </span><span class="token" style="color:#569cd6">--></span><span> F</span><span class="token text" style="color:#ce9178">[0.1000000000000000055...]</span><span>
</span>    
<span>    G</span><span class="token text" style="color:#ce9178">[Decimal Number 0.2]</span><span> </span><span class="token" style="color:#569cd6">--></span><span> H</span><span class="token text" style="color:#ce9178">[Convert to Binary]</span><span>
</span><span>    H </span><span class="token" style="color:#569cd6">--></span><span> I</span><span class="token text" style="color:#ce9178">[0.0011001100110011...]</span><span>
</span><span>    I </span><span class="token" style="color:#569cd6">--></span><span> J</span><span class="token text" style="color:#ce9178">[Infinite Binary Representation]</span><span>
</span><span>    J </span><span class="token" style="color:#569cd6">--></span><span> K</span><span class="token text" style="color:#ce9178">[Must Round to Fit 64-bit]</span><span>
</span><span>    K </span><span class="token" style="color:#569cd6">--></span><span> L</span><span class="token text" style="color:#ce9178">[0.2000000000000000111...]</span><span>
</span>    
<span>    F </span><span class="token" style="color:#569cd6">--></span><span> M</span><span class="token text" style="color:#ce9178">[Add Binary Representations]</span><span>
</span><span>    L </span><span class="token" style="color:#569cd6">--></span><span> M
</span><span>    M </span><span class="token" style="color:#569cd6">--></span><span> N</span><span class="token text" style="color:#ce9178">[0.3000000000000000444...]</span><span>
</span><span>    N </span><span class="token" style="color:#569cd6">--></span><span> O</span><span class="token text" style="color:#ce9178">[Display as 0.30000000000000004]</span></code></div></details></pre><p>Decimal fractions like 0.1, 0.2, and 0.3 do not have a finite binary representation, similar to how 1/3 does not have a finite decimal representation (it's 0.333...). When these numbers are stored in a computer's memory using a fixed number of bits (like 64-bit floating-point numbers, the standard), they must be rounded to the nearest representable binary fraction.</p><p>This means that the numbers <code>0.1</code> and <code>0.2</code> as stored in memory are <em>not</em> precisely the decimal values 0.1 and 0.2. They are the closest binary floating-point numbers to those values.</p><p>According to the web article from jvns.ca, the exact 64-bit floating-point representations of 0.1 and 0.2 are:</p><ul><li><code>0.1</code> is actually <code>0.1000000000000000055511151231257827021181583404541015625</code></li><li><code>0.2</code> is actually <code>0.200000000000000011102230246251565404236316680908203125</code></li></ul><h2 id="adding-the-inexact-values">Adding the Inexact Values</h2><p>When you add these two inexact binary representations, you get a sum that is also inexact: <code>0.1000000000000000055511151231257827021181583404541015625 + 0.200000000000000011102230246251565404236316680908203125 = 0.3000000000000000166533453693773481063544750213623046875</code></p><p>This sum is then rounded to the nearest representable 64-bit floating-point number. The IEEE 754 standard, which defines floating-point arithmetic for most systems, specifies how this rounding should occur. The standard typically uses "round to nearest, ties to even".</p><p>In the case of <code>0.1 + 0.2</code>, the exact sum <code>0.3000000000000000166533453693773481063544750213623046875</code> lies exactly between two representable floating-point numbers:</p><ul><li><code>0.299999999999999988897769753748434595763683319091796875</code> (often displayed as 0.3)</li><li><code>0.3000000000000000444089209850062616169452667236328125</code> (often displayed as 0.30000000000000004)</li></ul><p>Since the sum is exactly in the middle, the "ties to even" rule is applied. This rule dictates that the number is rounded to the floating-point number whose last bit of the significand is 0 (i.e., is even). In this case, <code>0.3000000000000000444089209850062616169452667236328125</code> is the one with the even significand, so it is chosen as the result.</p><h2 id="the-role-of-ieee-754">The Role of IEEE 754</h2><p>This behavior is governed by the IEEE 754 standard for floating-point arithmetic, which is implemented in the hardware of most modern computers and used by the vast majority of programming languages. The standard defines the formats for representing floating-point numbers (like single-precision 32-bit and double-precision 64-bit) and the rules for performing arithmetic operations, including addition, subtraction, multiplication, division, and rounding. Adhering to IEEE 754 ensures consistency in floating-point computations across different platforms.</p><h2 id="demonstrations-in-code">Demonstrations in Code</h2><p>Let's see this in action in various programming languages.</p><p><strong>JavaScript / TypeScript:</strong></p><pre><h3 class="Article__CondingLang">javascript:</h3><div style='color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e'><code class="language-javascript" style='white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#b5cea8">0.1</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> </span><span class="token" style="color:#b5cea8">0.2</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#6a9955">// Expected output: 0.30000000000000004</span></code></div></pre><p><strong>Python:</strong></p><pre><h3 class="Article__CondingLang">python:</h3><div style='color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e'><code class="language-python" style='white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#569cd6">print</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#b5cea8">0.1</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> </span><span class="token" style="color:#b5cea8">0.2</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">//</span><span> Expected output</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#b5cea8">0.30000000000000004</span></code></div></pre><p><strong>C++:</strong></p><pre><h3 class="Article__CondingLang">cpp:</h3><div style='color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e'><code class="language-cpp" style='white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token macro directive-hash" style="color:#9cdcfe">#</span><span class="token macro directive" style="color:#569cd6">include</span><span class="token macro" style="color:#9cdcfe"> </span><span class="token macro" style="color:#ce9178">&lt;iostream></span><span>
</span><span></span><span class="token macro directive-hash" style="color:#9cdcfe">#</span><span class="token macro directive" style="color:#569cd6">include</span><span class="token macro" style="color:#9cdcfe"> </span><span class="token macro" style="color:#ce9178">&lt;iomanip></span><span>
</span>
<span></span><span class="token" style="color:#569cd6">int</span><span> </span><span class="token" style="color:#dcdcaa">main</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>    </span><span class="token" style="color:#569cd6">double</span><span> result </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">0.1</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> </span><span class="token" style="color:#b5cea8">0.2</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    std</span><span class="token double-colon" style="color:#d4d4d4">::</span><span>cout </span><span class="token" style="color:#d4d4d4">&lt;&lt;</span><span> std</span><span class="token double-colon" style="color:#d4d4d4">::</span><span>fixed </span><span class="token" style="color:#d4d4d4">&lt;&lt;</span><span> std</span><span class="token double-colon" style="color:#d4d4d4">::</span><span class="token" style="color:#dcdcaa">setprecision</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#b5cea8">17</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">&lt;&lt;</span><span> result </span><span class="token" style="color:#d4d4d4">&lt;&lt;</span><span> std</span><span class="token double-colon" style="color:#d4d4d4">::</span><span>endl</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token" style="color:#569cd6">return</span><span> </span><span class="token" style="color:#b5cea8">0</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span><span>
</span><span></span><span class="token" style="color:#6a9955">// Expected output: 0.30000000000000004</span></code></div></pre><p><em>Note: You need <code>&lt;iomanip></code> to control precision for printing.</em></p><p><strong>Rust:</strong></p><pre><h3 class="Article__CondingLang">rust:</h3><div style='color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e'><code class="language-rust" style='white-space:pre;color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#569cd6">fn</span><span> </span><span class="token function-definition" style="color:#dcdcaa">main</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">{</span><span>
</span><span>    </span><span class="token" style="color:#569cd6">let</span><span> result</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#569cd6">f64</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">0.1</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> </span><span class="token" style="color:#b5cea8">0.2</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span>    </span><span class="token macro" style="color:#9cdcfe">println!</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">"{:.17}"</span><span class="token" style="color:#d4d4d4">,</span><span> result</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">}</span><span>
</span><span></span><span class="token" style="color:#6a9955">// Expected output: 0.30000000000000004</span></code></div></pre><p><em>Note: <code>f64</code> is the standard 64-bit floating-point type.</em></p><h2 id="why-it-matters-and-how-to-handle-it">Why it Matters and How to Handle It</h2><p>Understanding this behavior is crucial, especially when dealing with financial calculations or any situation where exact decimal precision is required. Relying on direct floating-point equality checks (<code>if (a + b == c)</code>) can lead to bugs because <code>0.1 + 0.2</code> will not be strictly equal to <code>0.3</code>.</p><p>For scenarios requiring exact decimal arithmetic, consider using dedicated decimal data types or libraries if your language provides them (e.g., Python's <code>decimal</code> module, Java's <code>BigDecimal</code>). Alternatively, work with integers by scaling your numbers (e.g., deal with cents instead of dollars).</p><h3 id="javascript-typescript-using-bigint-for-integer-arithmetic">JavaScript/TypeScript: Using <code>BigInt</code> for Integer Arithmetic</h3><p>In JavaScript and TypeScript, when working with scaled integers to avoid floating-point inaccuracies, <code>BigInt</code> is an invaluable tool, especially for numbers outside the safe integer range of the standard <code>Number</code> type. <code>BigInt</code> provides a way to represent whole numbers with arbitrary precision.</p><p>Here's how you can use <code>BigInt</code> to perform calculations that might otherwise be unsafe with standard numbers:</p><pre><h3 class="Article__CondingLang">javascript:</h3><div style='color:#d4d4d4;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e'><code class="language-javascript" style='white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token" style="color:#6a9955">// A safe integer limit</span><span>
</span><span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span class="token known-class-name" style="color:#4ec9b0">Number</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#9cdcfe">MAX_SAFE_INTEGER</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// 9007199254740991</span><span>
</span>
<span></span><span class="token" style="color:#6a9955">// BigInt math (Correct)</span><span>
</span><span></span><span class="token" style="color:#569cd6">const</span><span> safe </span><span class="token" style="color:#d4d4d4">=</span><span> maxSafeInteger </span><span class="token" style="color:#d4d4d4">+</span><span> </span><span class="token known-class-name" style="color:#4ec9b0">BigInt</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#b5cea8">2</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// or 2n</span><span>
</span><span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span>safe</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">toString</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// "9007199254740993" (Correct)</span><span>
</span>
<span></span><span class="token" style="color:#6a9955">// Out of max safe integer without BigInt usage (Incorrect)</span><span>
</span><span></span><span class="token" style="color:#4ec9b0">console</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">log</span><span class="token" style="color:#d4d4d4">(</span><span class="token known-class-name" style="color:#4ec9b0">Number</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#9cdcfe">MAX_SAFE_INTEGER</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> </span><span class="token" style="color:#b5cea8">2</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span> </span><span class="token" style="color:#6a9955">// 9007199254740992 (Incorrect)</span></code></div></pre></div></div></div></div><footer class="Footer">The API for this site <a href="https://github.com/shapkarin/shapkarin.me/tree/master/src/Generate-Backend" target="_blank" rel="noreferrer">is generated<svg fill="none" height="12" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="12" xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round" style="margin-left:2px"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg></a>and stored as <a href="https://github.com/shapkarin/shapkarin.me/tree/gh-pages/api" target="_blank" rel="noreferrer">JSON and Markdown<svg fill="none" height="12" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="12" xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round" style="margin-left:2px"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg></a>on GitHub Pages.<br>It <a href="https://github.com/shapkarin/shapkarin.me/blob/main/.github/workflows/build-deploy.yml" target="_blank" rel="noreferrer">uses Github Actions<svg fill="none" height="12" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="12" xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round" style="margin-left:2px"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg></a>to help with CI and generates a static version.</footer></div><canvas height="850" id="background" width="480"></canvas></body></html>